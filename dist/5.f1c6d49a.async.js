(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{ZS7o:function(e,a,t){"use strict";t.r(a);var n=t("q1tI"),c=t.n(n),l=t("hWJ+"),s=t("/MKj"),i=(t("Pwec"),t("CtXQ")),r=t("qIgq"),d=t.n(r),o=(t("/zsF"),t("PArb")),p=t("p0pE"),u=t.n(p),m=t("Y/ft"),b=t.n(m),g=t("tlA2"),h=t.n(g),_=t("JwKJ"),y=t("d6i3"),f=t.n(y),E=t("jehZ"),v=t.n(E),O=(t("miYZ"),t("tsqr")),w=t("1l/V"),C=t.n(w),j=t("T99t"),x=t("pGep"),k=t("9Knd"),S=t("r7dy"),N=t("4/LA"),I=e=>{e.adaccount_id;var a=e.title,t=void 0===a?"\u521b\u5efa\u5e7f\u544a\u7ec4":a,l=e.visible,s=e.setVisible,i=e.initailState,r=e.updateTable,o=e.adset_id,p=e.campaignData,m=Object(n["useReducer"])(N["c"],i),b=d()(m,2),g=b[0],h=b[1],_=Object(k["a"])(o);function y(e){return E.apply(this,arguments)}function E(){return E=C()(f.a.mark(function e(a){var t;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,x["updateAdset"](o,u()({},g));case 2:t=e.sent,t.success&&w("\u66f4\u65b0\u6210\u529f !",a);case 4:case"end":return e.stop()}},e)})),E.apply(this,arguments)}function w(e,a){a(!1),r(),O["a"].success(e),s(!1)}return g.name!==i.name&&o!==_&&h({type:"reset",payload:i}),c.a.createElement(j["a"],{width:1e3,title:t,visible:l,handle:e=>{y(e)},handleCancel:()=>{h({type:"reset",payload:i}),s(!1)}},c.a.createElement(S["a"],v()({state:g,dispatch:h},p,{edit:!0})))},T=t("3a4m"),R=t.n(T),A=t("hQyA"),J=e=>{var a=e.selectKeys,t=e.data,l=e.search,s=e.loading,i=e.updateTable,r=e.dispatch,p=e.campaigns_select,m=e.setCopyModel,g=e.copied_id,y=t.filter(e=>-1!==A["c"].indexOf(e.campaign.objective)),f=Object(n["useState"])(!1),E=d()(f,2),v=E[0],O=E[1],w=Object(n["useState"])(null),C=d()(w,2),j=C[0],x=C[1],k=Object(n["useState"])(null),S=d()(k,2),N=S[0],T=S[1],J=Object(n["useState"])(null),K=d()(J,2),P=K[0],V=K[1];function q(e){x(e.id);var a=e.campaign,t=b()(e,["campaign"]);t.daily_budget&&(t.daily_budget=t.daily_budget/100),t.bid_amount&&(t.bid_amount=t.bid_amount/100),V(a),T(u()({},t)),O(!0)}Object(n["useEffect"])(()=>{if(g){var e=t.find(e=>e.id===g);q(e),r({type:"global/set_copied_id",payload:""})}return()=>{}},[g,t,r]);var D=[{title:"\u5e7f\u544a\u7ec4\u540d\u79f0",dataIndex:"name",render:(e,a)=>c.a.createElement("span",{className:h.a._a,onClick:e=>{r({type:"global/set_adsets",payload:[a]}),R.a.push("/ad")}},e)},{title:"\u8425\u9500\u76ee\u6807",dataIndex:"objective",render:(e,a)=>c.a.createElement("span",null,a.campaign.objective)},{title:"\u6295\u653e\u72b6\u6001",dataIndex:"status",sorter:(e,a)=>e.status.toString().localeCompare(a.status),render:e=>e},{title:"\u64cd\u4f5c",key:"action",width:"15%",render:(e,a)=>c.a.createElement("span",null,c.a.createElement("span",{className:h.a._a,onClick:e=>{q(a)}},"\u7f16\u8f91"),c.a.createElement(o["a"],{type:"vertical"}),c.a.createElement("span",{className:h.a._a,onClick:e=>{r({type:"global/set_adsets",payload:[a]}),m(!0)}},"\u590d\u5236"))}],F={bordered:!0,rowSelection:{onChange(e,a){console.log(e,a),r({type:"global/set_adsets",payload:a})},selectedRowKeys:a},pagination:{defaultPageSize:200,showQuickJumper:!0},scroll:t.length>20?{y:"calc(100vh - 343px)"}:void 0};return c.a.createElement(c.a.Fragment,null,c.a.createElement(_["a"],{params:F,dataSource:p.length?y.filter(e=>-1!==p.indexOf(e.campaign_id)):y,columns:D,loading:s,search:l}),N?c.a.createElement(I,{campaignData:P,title:"\u7f16\u8f91\u5e7f\u544a\u7ec4",visible:v,setVisible:O,updateTable:i,adset_id:j,initailState:N,edit:!0}):"")},K=(e,a)=>{return{selectKeys:e.global.adsets.map(e=>e.key),campaigns_select:e.global.campaigns.map(e=>e.id),copied_id:e.global.copied_id}},P=Object(s["c"])(K)(J),V=t("m5kd"),q=(t("OaEy"),t("2fM7")),D=t("glEz"),F=t("hqdU"),L=t("RRGs"),M=t("7Qib"),W=t("7IlV"),G=t.n(W),Q=q["a"].Option,z=[{name:"\u539f\u6709\u5e7f\u544a\u7cfb\u5217",key:"ORIGINAL"},{name:"\u5176\u4ed6\u5e7f\u544a\u7cfb\u5217",key:"OTHER"},{name:"\u65b0\u5e7f\u544a\u7cfb\u5217",key:"NEW"}],Z=e=>{var a=e.adsets,t=e.dispatch,l=e.title,s=e.visible,i=e.setVisible,r=e.updateTable,p=e.adaccount_id,m=e.campaigns_cache,b=Object(n["useState"])(1),g=d()(b,2),h=g[0],_=g[1],y=Object(n["useState"])("ORIGINAL"),E=d()(y,2),v=E[0],w=E[1],k=Object(n["useState"])([]),S=d()(k,2),N=S[0],I=S[1],T=Object(n["useState"])(null),R=d()(T,2),J=R[0],K=R[1],P=Object(n["useReducer"])(A["d"],A["b"]),V=d()(P,2),W=V[0],Z=V[1];function H(e){return Y.apply(this,arguments)}function Y(){return Y=C()(f.a.mark(function e(n){var c,l,s,d,o,m;return f.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(c=J,"NEW"!==v){e.next=8;break}if(W.name){e.next=4;break}return e.abrupt("return",O["a"].warning("\u8bf7\u8f93\u5165\u5e7f\u544a\u7cfb\u5217\u540d\u79f0 !"));case 4:return e.next=6,x["createCampaign"](p,u()({},Object(M["c"])(W)));case 6:l=e.sent,l.id&&(O["a"].success("\u521b\u5efa\u5e7f\u544a\u7cfb\u5217".concat(W.name,"\u6210\u529f")),c=l.id);case 8:if(s=[],h>1)for(d=0;d<h;d++)s=[...s,...a.slice()];else s=[...s,...a.slice()];if(!c){e.next=16;break}return e.next=13,x["Copy"](s,"campaign_id=".concat(c));case 13:e.t0=e.sent,e.next=19;break;case 16:return e.next=18,x["Copy"](s);case 18:e.t0=e.sent;case 19:if(o=e.t0,!o){e.next=29;break}return console.log(o),n(!1),i(!1),t({type:"global/set_adsets",payload:[]}),e.next=27,r();case 27:m=JSON.parse(o[0].result).copied_adset_id,t({type:"global/set_copied_id",payload:m});case 29:case"end":return e.stop()}},e)})),Y.apply(this,arguments)}function U(e){K(e)}return Object(n["useEffect"])(()=>{var e=!1;function a(){return n.apply(this,arguments)}function n(){return n=C()(f.a.mark(function a(){var n,c;return f.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,x["getCampaign"](p);case 2:n=a.sent,c=n.data,e||(I(c),t({type:"global/set_campaigns_cache",payload:{data:c,isFetch:!1}}));case 5:case"end":return a.stop()}},a)})),n.apply(this,arguments)}return p&&m.isFetch?a():I(m.data),()=>{e=!0}},[p,m,t]),c.a.createElement(j["a"],{width:700,title:l,visible:s,handle:e=>{H(e)},handleCancel:()=>{i(!1)}},c.a.createElement("div",null,c.a.createElement(F["a"],{options:z,pattern:v,onChange:e=>{w(e.target.value)}}),"OTHER"===v&&c.a.createElement("div",{className:G.a.select_container},c.a.createElement(q["a"],{showSearch:!0,style:{width:"100%"},placeholder:"\u9009\u62e9\u5e7f\u544a\u7cfb\u5217",optionFilterProp:"children",onChange:U,filterOption:(e,a)=>a.props.children.toLowerCase().indexOf(e.toLowerCase())>=0},N.map((e,a)=>c.a.createElement(Q,{key:e.id,value:e.id},e.name)))),"NEW"===v&&c.a.createElement("div",{className:G.a.select_container},c.a.createElement(L["a"],{state:W,dispatch:Z})),c.a.createElement(o["a"],null),c.a.createElement(D["a"],{setNum:_,label:"\u6bcf\u4e2a\u5e7f\u544a\u7ec4\u7684\u526f\u672c\u6570\u91cf"})))},H=(e,a)=>{return{adsets:e.global.adsets,campaigns_cache:e.global.campaigns_cache,adaccount_id:e.global.adaccount_id}},Y=Object(s["c"])(H)(Z),U=c.a.memo(e=>{var a=e.campaigns_select_length,t=e.dispatch,l=e.adaccount_id,s=e.data,r=e.setSearch,o=e.defaultCurrent,p=e.total,u=e.paging,m=e.nextOrPrevious,b=e.setDefaultCurrent,g=e.loading,_=e.search,y=e.updateTable,f=e.adsets,E=Object(n["useState"])(!1),v=d()(E,2),O=v[0],w=v[1];return c.a.createElement("div",{className:h.a.adset},c.a.createElement(V["a"],{adaccount_id:l,setSearch:r,defaultCurrent:o,total:p,paging:u,loading:g,num:50,nextOrPrevious:m,setDefaultCurrent:b,setCopyModel:w,copy_bool:f.length>0,createDirection:"adsets"},a>0&&c.a.createElement("span",{className:h.a.select_close,onClick:()=>t({type:"global/set_campaigns",payload:[]})},"\u5df2\u9009\u4e2d",a,"\u9879\u5e7f\u544a\u7cfb\u5217"," ",c.a.createElement(i["a"],{type:"close-circle"}))),c.a.createElement(P,{data:s,loading:g,search:_,updateTable:y,setCopyModel:w}),c.a.createElement(Y,{title:"\u628a\u5e7f\u544a\u7ec4\u590d\u5236\u5230",visible:O,setVisible:w,updateTable:y}))}),X=(e,a)=>{return{campaigns_select_length:e.global.campaigns.map(e=>e.id).length,adsets:e.global.adsets}},B=Object(s["c"])(X)(U),$=e=>{var a=e.adaccount_id;return c.a.createElement(l["a"],{WrappedComponent:B,method:"getAdset",adaccount_id:a})},ee=(e,a)=>{return{adaccount_id:e.global.adaccount_id}};a["default"]=Object(s["c"])(ee)($)}}]);